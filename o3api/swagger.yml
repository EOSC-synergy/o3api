swagger: "2.0"
info:
  description: This is the swagger file that goes with our server code
  version: "1.0.0"
  title: Swagger REST API for O3as
consumes:
  - "application/json"

basePath: "/api"

# Paths supported by the server application
paths:
  /api-info:
    get:
      operationId: "o3api.api.get_api_info"
      tags:
        - "api-info"
      summary: "Returning information about the service"
      description: "Return o3api metadata"
      produces:
        - "application/json"
      responses:
        200:
          description: "Successfully returned o3api info"
          schema:
            $ref: '#/definitions/MetaInfo'
  /models:
    get:
      operationId: "o3api.api.get_models_info"
      tags:
        - "models"
      summary: "Returning list of available models + short info"
      description: "Return list of models + short info"
      produces:
        - "application/json"
      responses:
        200:
          description: "Successfully returned list of models"
          schema:
            $ref: '#/definitions/Models'
  /models/list/{ptype}:
    post:
      operationId: "o3api.api.list_models"
      tags:
        - "models"
      summary: "Returning list of models for a certain plot type"
      description: "Return list of models for a certain plot type"
      produces:
        - "application/json"
      parameters:
        - name: ptype
          in: path
          type: string
          description: Plot type (all, tco3_zm, vmro3_zm, tco3_return)
          default: "all"
          required: true
        - name: select
          in: query
          type: string
          description: Select models according to the {select} pattern
          required: false
      responses:
        200:
          description: "Successfully returned list of models"
          schema:
            $ref: '#/definitions/ListModels'
  /models/{model}:
    get:
      operationId: "o3api.api.get_model_detail"
      tags:
        - "models"
      summary: "Returning detailed information about a model"
      description: "Return detailed model info"
      produces:
        - "application/json"
      parameters:
        - name: model
          in: path
          type: string
          description: model name
          default: CCMI-1_ACCESS-refC2
          required: true
      responses:
        200:
          description: "Successfully returned model information"
          schema:
            $ref: '#/definitions/ModelInfo'
  /plots:
    get:
      operationId: "o3api.api.get_plots"
      tags:
        - "plots"
      summary: "Get the list of possible plots"
      description: "Get the list of possible plots"
      produces:
        - "application/json"
      responses:
        200:
          description: "Successfully returned the list of possible plots"
          schema:
            $ref: '#/definitions/ListPlots'
  /plots/tco3_zm:
    post:
      operationId: "o3api.api.tco3_zm"
      tags:
        - "plots"
      summary: "Create tco3_zm plot"
      description: "Create tco3_zm plot"
      produces:
        - "application/pdf"
        - "application/json"
      parameters:
        - name: model
          in: query
          type: array
          items:
            type: string
          description: Name(s) of model(s) (dataset-model)
          default: [CCMI-1_ACCESS-refC2,CCMI-1_CCCma-CMAM-refC2,CCMI-1_CHASER-MIROC-ESM-refC2]
          required: true
        - name: begin
          in: query
          type: integer
          description: Year to start data scanning from
          default: 1959
          required: false
        - name: end
          in: query
          type: integer
          description: Year to finish data scanning
          default: 2100
          required: false
        - name: month
          in: query
          type: array
          items:
            type: integer
          description: Month(s) to select, if not a whole year
          default: []
          required: false
        - name: lat_min
          in: query
          type: integer
          description: Latitude (min) to define the range (-90..90)
          default: -10
          required: false
        - name: lat_max
          in: query
          type: integer
          description: Latitude (max) to define the range (-90..90)
          default: 10
          required: false
      responses:
        200:
          description: "Successfully created a plot"
          schema:
            type: file
          schema:
            $ref: '#/definitions/TCO3Data'
#        default:
#          description: "Unexpected error"
#          schema:
#            $ref: "#/definitions/Error"
  /plots/vmro3_zm:
    post:
      operationId: "o3api.api.vmro3_zm"
      tags:
        - "plots"
      summary: "Create vmro3_zm plot"
      description: "Create vmro3_zm plot"
      produces:
        - "application/pdf"
        - "application/json"
      parameters:
        - name: model
          in: query
          type: array
          items:
            type: string
          description: Name(s) of model(s) (dataset-model)
          default: [CCMI-1_ACCESS-refC2,CCMI-1_CCCma-CMAM-refC2,CCMI-1_CHASER-MIROC-ESM-refC2]
          required: true
        - name: begin
          in: query
          type: integer
          description: Year to start data scanning from
          default: 1959
          required: false
        - name: end
          in: query
          type: integer
          description: Year to finish data scanning
          default: 2100
          required: false
      responses:
        200:
          description: "Successfully created a plot"
          schema:
            type: file
          schema:
            $ref: '#/definitions/VMRO3Data'
  /plots/tco3_return:
    post:
      operationId: "o3api.api.tco3_return"
      tags:
        - "plots"
      summary: "Create tco3_return plot"
      description: "Create tco3_return plot"
      produces:
        - "application/pdf"
        - "application/json"
      parameters:
        - name: model
          in: query
          type: array
          items:
            type: string
          description: Name(s) of model(s) (dataset-model)
          default: [CCMI-1_ACCESS-refC2,CCMI-1_CCCma-CMAM-refC2,CCMI-1_CHASER-MIROC-ESM-refC2]
          required: true
        - name: begin
          in: query
          type: integer
          description: Year to start data scanning from
          default: 1959
          required: false
        - name: end
          in: query
          type: integer
          description: Year to finish data scanning
          default: 2100
          required: false
      responses:
        200:
          description: "Successfully created a plot"
          schema:
            type: file
          schema:
            $ref: '#/definitions/TCO3ReturnData'
definitions:
  MetaInfo:
    type: object
    properties:
      author:
        type: string
      author-email:
        type: string
      home-page:
        type: string
      license:
        type: string
      name:
        type: string
      summary:
        type: string
      version:
        type: string
  Models:
    type: array
    items:        
      properties:
        info:
          type: string
        model:
          type: string
        url:
          type: string
        tco3_zm:
          type: object
        tco3_return:
          type: object
        vmro3_zm:
          type: object
  ListModels:
    type: array
    items:
      type: string
  ModelInfo:
    type: object
    properties:
      info:
        type: string
      model:
        type: string
      url:
        type: string
      tco3_zm:
        type: object
      tco3_return:
        type: object
      vmro3_zm:
        type: object
  ListPlots:
    type: object
    properties:
      plots:
        type: array
        items:
          type: string
  TCO3Data:
    type: array
    items:        
      properties:
        model:
          type: string
        x:
          type: array
        y:
          type: array
  VMRO3Data:
    type: array
    items:        
      properties:
        model:
          type: string
        x:
          type: array
        y:
          type: array
  TCO3ReturnData:
    type: array
    items:        
      properties:
        model:
          type: string
        x:
          type: array
        y:
          type: array
  Error:
    type: string
